{"openapi":"3.0.0","paths":{"/levels":{"post":{"operationId":"LevelController_create","summary":"","description":"Create a Level record by supplying its name, oxygen budget and list of points.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateLevel"}}}},"responses":{"201":{"description":"The level has been successfully created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublicLevel"}}}},"400":{"description":"Request body was not valid"},"401":{"description":"User was not logged in or does not have correct permissions "},"409":{"description":"The database rejected the new Level record"},"500":{"description":"The server couldn't persist the Level record due to an unknown error"}},"tags":["levels"],"security":[{"authorization":[]}]},"get":{"operationId":"LevelController_findAll","summary":"","description":"Find all trees, optionally paginated with `limit` and `offset`.","parameters":[{"name":"limit","required":false,"in":"query","description":"Limit the number of records returned","schema":{"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Offset the start of the returned records","schema":{"type":"number"}},{"required":false,"description":"Limit the number of records returned","name":"limit","in":"query","schema":{"type":"number"}},{"required":false,"description":"Offset the start of the returned records","name":"offset","in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PublicLevel"}}}}},"400":{"description":"Request body was not valid"}},"tags":["levels"]}},"/levels/tree":{"get":{"operationId":"LevelController_tree","summary":"","description":"Get the nested tree structure of levels","parameters":[],"responses":{"200":{"description":"Fully realized tree of levels","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TreeLevel"}}}},"400":{"description":"Request body was not valid"},"404":{"description":"No levels have been created yet"}},"tags":["levels"]}},"/levels/tree/{id}":{"get":{"operationId":"LevelController_subtree","summary":"","description":"Return the fully realized subtree starting from the level at the given ID","parameters":[{"name":"id","required":true,"in":"path","description":"Level ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Realized subtree","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TreeLevel"}}}},"400":{"description":"Request body was not valid"},"401":{"description":"User was not logged in or does not have correct permissions "},"404":{"description":"Subroot level was not found"}},"tags":["levels"],"security":[{"authorization":[]}]}},"/levels/{id}":{"get":{"operationId":"LevelController_findOne","summary":"","description":"Get a Level record by its ID","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublicLevel"}}}},"400":{"description":"Request body was not valid"},"401":{"description":"User was not logged in or does not have correct permissions "},"404":{"description":""}},"tags":["levels"],"security":[{"authorization":[]}]},"patch":{"operationId":"LevelController_update","summary":"","description":"Update the Level record matching the provided ID","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateLevel"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublicLevel"}}}},"400":{"description":"Request body was not valid"},"401":{"description":"User was not logged in or does not have correct permissions "},"404":{"description":""}},"tags":["levels"],"security":[{"authorization":[]}]},"delete":{"operationId":"LevelController_remove","summary":"","description":"Delete a Level record from persistence","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Removed the Level record with the matching ID, returning true if it existed","content":{"application/json":{"schema":{"type":"boolean"}}}},"400":{"description":"Request body was not valid"},"401":{"description":"User was not logged in or does not have correct permissions "}},"tags":["levels"],"security":[{"authorization":[]}]}},"/levels/solve":{"post":{"operationId":"LevelController_verifySolve","summary":"","description":"Submit a solve for verification","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Solve"}}}},"responses":{"200":{"description":"The verified solve","content":{"application/json":{"schema":{"type":"boolean"}}}},"400":{"description":"Request body was not valid"},"401":{"description":"User was not logged in or does not have correct permissions "},"404":{"description":"The level ID did not match any existing records"}},"tags":["levels"],"security":[{"authorization":[]}]}},"/users":{"post":{"operationId":"UserController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUser"}}}},"responses":{"201":{"description":"Returns the newly created User object","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublicUser"}}}},"400":{"description":"Passwords did not match"},"401":{"description":"User was not logged in or does not have correct permissions "}},"tags":["users"],"security":[{"authorization":[]}]},"get":{"operationId":"UserController_findAll","parameters":[{"name":"limit","required":false,"in":"query","description":"Limit the number of records returned","schema":{"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Offset the start of the returned records","schema":{"type":"number"}}],"responses":{"200":{"description":"Return all active users","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PublicUser"}}}}},"400":{"description":"Request data validation failed"},"401":{"description":"User does not have required permissions"}},"tags":["users"]}},"/users/inactive":{"get":{"operationId":"UserController_findInactive","parameters":[{"name":"limit","required":false,"in":"query","description":"Limit the number of records returned","schema":{"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Offset the start of the returned records","schema":{"type":"number"}}],"responses":{"200":{"description":"Return all active users, including inactive ones","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PublicUser"}}}}},"400":{"description":"Request data validation failed"},"401":{"description":"User was not logged in or does not have correct permissions "}},"tags":["users"],"security":[{"authorization":[]}]}},"/users/activate":{"get":{"operationId":"UserController_activateAccount","parameters":[{"name":"token","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"201":{"description":""},"204":{"description":"User was activated successfully"},"400":{"description":"Token was incorrect or expired"},"401":{"description":"User does not have required permissions"}},"tags":["users"]}},"/users/{id}":{"get":{"operationId":"UserController_findOne","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"User matching the provided ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublicUser"}}}},"400":{"description":"Request data validation failed"},"401":{"description":"User does not have required permissions"},"404":{"description":"No matching user found with this ID"}},"tags":["users"]},"patch":{"operationId":"UserController_update","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUser"}}}},"responses":{"200":{"description":""},"400":{"description":"Request data validation failed"},"401":{"description":"User was not logged in or does not have correct permissions "},"404":{"description":"No matching user found with this ID"}},"tags":["users"],"security":[{"authorization":[]}]},"delete":{"operationId":"UserController_remove","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""},"400":{"description":"Request data validation failed"},"401":{"description":"User was not logged in or does not have correct permissions "},"404":{"description":"No matching user found with this ID"}},"tags":["users"],"security":[{"authorization":[]}]}},"/auth/login":{"post":{"operationId":"AuthController_login","parameters":[],"requestBody":{"required":true,"description":"Login credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Login"}}}},"responses":{"200":{"description":"User details, along with a `token` value that contains the Bearer token to use on authenticated requests","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoggedInUser"}}}},"400":{"description":"Request data validation failed"},"401":{"description":"Username and/or password did not match"}},"tags":["auth"]}},"/auth/profile":{"get":{"operationId":"AuthController_profile","parameters":[],"responses":{"200":{"description":"Currently logged in user details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublicUser"}}}},"400":{"description":"Request data validation failed"},"401":{"description":"User was not logged in or does not have correct permissions "}},"tags":["auth"],"security":[{"authorization":[]}]}}},"info":{"title":"PR083 Web API","description":"","version":"1.0.0-rc3","contact":{"name":"CodeAnon","url":"https://codeanon.org","email":"contact@codeanon.org"},"license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"}},"tags":[],"servers":[],"components":{"securitySchemes":{"authorization":{"scheme":"bearer","bearerFormat":"JWT","type":"http"}},"schemas":{"Point":{"type":"object","properties":{"x":{"type":"number"},"y":{"type":"number"}},"required":["x","y"]},"CreateLevel":{"type":"object","properties":{"name":{"type":"string"},"parent":{"type":"string"},"oxygen":{"type":"number"},"points":{"type":"array","items":{"$ref":"#/components/schemas/Point"}}},"required":["name","oxygen","points"]},"PublicUser":{"type":"object","properties":{"id":{"type":"string","description":"User ID"},"username":{"type":"string","description":"Unique username","maxLength":50},"email":{"type":"string","description":"Unique email","maxLength":255},"publicName":{"type":"string","nullable":true,"description":"Optional public display name","maxLength":50},"roles":{"type":"array","items":{"type":"string","enum":["USER","ADMIN"]},"description":"Roles associated to the user","minLength":1},"createdAt":{"format":"date-time","type":"string","description":"User creation date"},"updatedAt":{"format":"date-time","type":"string","description":"User last modification date"},"lastLogin":{"format":"date-time","type":"string","nullable":true,"description":"Date of last login"},"isActive":{"type":"boolean","readOnly":true,"description":"Is user active"},"displayName":{"type":"string","readOnly":true,"description":"User's computed display name (username if public name isn't specified"},"deletedAt":{"format":"date-time","type":"string"}},"required":["id","username","email","roles","createdAt","updatedAt","isActive","displayName"]},"PublicLevel":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"slug":{"type":"string"},"oxygen":{"type":"number"},"points":{"type":"array","items":{"$ref":"#/components/schemas/Point"}},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"},"solvedBy":{"description":"Users having solved this level","type":"array","items":{"$ref":"#/components/schemas/PublicUser"}}},"required":["id","name","slug","oxygen","points","createdAt","updatedAt"]},"TreeLevel":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"slug":{"type":"string"},"oxygen":{"type":"number"},"points":{"type":"array","items":{"$ref":"#/components/schemas/Point"}},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"},"solvedBy":{"description":"Users having solved this level","type":"array","items":{"$ref":"#/components/schemas/PublicUser"}},"children":{"description":"The children levels of this level","type":"array","items":{"$ref":"#/components/schemas/TreeLevel"}}},"required":["id","name","slug","oxygen","points","createdAt","updatedAt","children"]},"UpdateLevel":{"type":"object","properties":{"name":{"type":"string"},"parent":{"type":"string"},"oxygen":{"type":"number"},"points":{"type":"array","items":{"$ref":"#/components/schemas/Point"}}}},"Solve":{"type":"object","properties":{"levelId":{"type":"string"},"entry":{"type":"string"}},"required":["levelId","entry"]},"CreateUser":{"type":"object","properties":{"password1":{"type":"string","minLength":8},"password2":{"type":"string","minLength":8},"email":{"type":"string","maxLength":255},"username":{"type":"string"},"publicName":{"type":"string","maxLength":50}},"required":["password1","password2","email","username"]},"UpdateUser":{"type":"object","properties":{"password1":{"type":"string","minLength":8},"password2":{"type":"string","minLength":8},"email":{"type":"string","maxLength":255},"username":{"type":"string"},"publicName":{"type":"string","maxLength":50}}},"Login":{"type":"object","properties":{"username":{"type":"string","maxLength":50},"password":{"type":"string","minLength":8}},"required":["username","password"]},"LoggedInUser":{"type":"object","properties":{"id":{"type":"string","description":"User ID"},"username":{"type":"string","description":"Unique username","maxLength":50},"email":{"type":"string","description":"Unique email","maxLength":255},"publicName":{"type":"string","nullable":true,"description":"Optional public display name","maxLength":50},"roles":{"type":"array","items":{"type":"string","enum":["USER","ADMIN"]},"description":"Roles associated to the user","minLength":1},"createdAt":{"format":"date-time","type":"string","description":"User creation date"},"updatedAt":{"format":"date-time","type":"string","description":"User last modification date"},"lastLogin":{"format":"date-time","type":"string","nullable":true,"description":"Date of last login"},"isActive":{"type":"boolean","readOnly":true,"description":"Is user active"},"displayName":{"type":"string","readOnly":true,"description":"User's computed display name (username if public name isn't specified"},"token":{"type":"string","description":"Bearer token, used to identify the user in authenticated requests","readOnly":true},"deletedAt":{"format":"date-time","type":"string"}},"required":["id","username","email","roles","createdAt","updatedAt","isActive","displayName","token"]}}}}